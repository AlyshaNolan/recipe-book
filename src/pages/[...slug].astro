---
import PageLayout from "../layouts/Base.astro";
import PageHelper from "../layouts/page.astro";
import { getCollection, type CollectionEntry } from "astro:content";

export interface Props {
  page: CollectionEntry<"pages">;
}

export async function getStaticPaths() {
  const pages = await getCollection("pages");
  return pages.map((page) => {
    const slug = page.slug.replace(/index$/, "");
    if (slug.length === 0)
      return { params: { slug: undefined }, props: { page } };
    return { params: { slug }, props: { page } };
  });
}

const { page } = Astro.props;
---
<PageLayout title={page.data.title} description={page.data.description} >
  <section class="grid grid-cols-mobile desktop:grid-cols-desktop py-16 gap-4">
    <div class="col-span-content">
      <PageHelper bookshop:live contentBlocks={page.data.content_blocks ?? []} />
    </div>
  </section>
</PageLayout>